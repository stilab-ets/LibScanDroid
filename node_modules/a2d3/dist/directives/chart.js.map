{"version":3,"sources":["../../src/angularD3/directives/chart.ts"],"names":[],"mappings":"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","file":"chart.js","sourceRoot":"","sourcesContent":["import { Input, Directive, Optional, ElementRef, OnInit } from '@angular/core';\nimport * as d3 from 'd3';\n\nexport interface ID3Element {\n  redraw(): void;\n}\n\nexport interface D3Scale {\n  name: string;\n  scale;\n  redraw(): void;\n}\n\n/*\n * Directive\n * D3Chart is the base element in building charts with AngularD3\n * <d3-chart></d3-chart>\n */\n\nexport class D3ChartDirective implements OnInit {\n  element: any;\n  chart: any;\n  scales: D3Scale[] = [];\n  elements: ID3Element[] = [];\n\n  private _data: {}[];\n\n  constructor(elementRef: ElementRef) {\n    this.element = elementRef.nativeElement;\n    this.chart = d3.select(this.element).attr('class', 'd3-chart');\n    window.addEventListener('resize', () => this.redraw());\n  }\n\n  get width(): number {\n    return this.element.parentElement.clientWidth;\n  }\n\n  set width(value: number) {\n    this.chart.attr('width', `${value}px`);\n  }\n\n  get height(): number {\n    return this.element.parentElement.clientHeight;\n  }\n\n  set height(value: number) {\n    this.chart.attr('height', `${value}px`);\n  }\n\n\n  addScale(scale: D3Scale) {\n    this.scales.push(scale);\n  }\n\n  getScale(name: string): D3Scale {\n    return this.scales.find(s => s.name === name);\n  }\n\n  addElement(element: ID3Element) {\n    this.elements.push(element);\n  }\n\n  \n  get data() {\n    return this._data || [];\n  }\n\n  set data(value: any) {\n    this._data = value;\n    this.redraw();\n  }\n\n  redraw() {\n    window.requestAnimationFrame(() => {\n      this.scales.forEach(e => { e.redraw(); });\n      this.elements.forEach(e => { e.redraw(); });\n    });\n  }\n\n  ngOnInit() {\n    this.redraw();\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Directive, args: [{\n  selector: '[d3-chart]'\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ElementRef, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'data': [{ type: Input },],\n};\n}\n\nexport interface D3Margin {\n  top: number;\n  left: number;\n  right: number;\n  bottom: number;\n}\n\n\nexport class D3MarginDirective implements ID3Element {\n  element;\n  private _margin: D3Margin = { top: 0, left: 0, bottom: 0, right: 0 };\n\n  constructor(public chart: D3ChartDirective, public el: ElementRef) {\n    this.element = d3.select(el.nativeElement);\n    chart.addElement(this);\n  }\n\n  get width(): number {\n    return this.chart.width - this.margin.left - this.margin.right;\n  }\n\n  get height(): number {\n    return this.chart.height - this.margin.top - this.margin.bottom;\n  }\n\n  \n  get margin(): D3Margin {\n    return this._margin;\n  }\n\n  set margin(value: D3Margin) {\n    if (value) {\n      if (this._margin === value) {\n        return;\n      }\n\n      this._margin = value;\n      this.redraw();\n      this.chart.redraw();\n    }\n  }\n\n  redraw() {\n    this.element\n      .attr('transform', `translate(${this.margin.left || '0'}, ${this.margin.top || '0'})`);\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Directive, args: [{\n  selector: '[d3-margin]'\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: D3ChartDirective, },\n{type: ElementRef, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'margin': [{ type: Input, args: ['d3-margin', ] },],\n};\n}\n\nexport class D3Element implements ID3Element {\n  element;\n  private _margin: D3Margin = { top: 0, left: 0, right: 0, bottom: 0 };\n\n  constructor(public chart: D3ChartDirective, public el: ElementRef,  private _marginEl?: D3MarginDirective) {\n    this.element = d3.select(el.nativeElement);\n    chart.addElement(this);\n  }\n\n  get margin(): D3Margin {\n    return this._marginEl ? this._marginEl.margin : this._margin;\n  }\n\n  get nativeElement() {\n    return this.el.nativeElement;\n  }\n\n  get width(): number {\n    return this._marginEl ? this._marginEl.width : this.chart.width;\n  }\n\n  get height(): number {\n    return this._marginEl ? this._marginEl.height : this.chart.height;\n  }\n\n  get data() {\n    return this.chart.data;\n  }\n\n  get horizontalPadding(): number {\n    return this.width - this.nativeElement.parentElement.clientWidth;\n  }\n\n  get verticalPadding(): number {\n    return this.height - this.nativeElement.parentElement.clientHeight;\n  }\n\n  getScale(name) {\n    return this.chart.getScale(name);\n  }\n\n  redraw() {\n    return;\n  }\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: D3ChartDirective, },\n{type: ElementRef, },\n{type: D3MarginDirective, decorators: [{ type: Optional }, ]},\n];\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}